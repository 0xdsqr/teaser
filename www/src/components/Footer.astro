---
import config from "virtual:starlight/user-config";
import { Icon } from "@astrojs/starlight/components";
import type { Props } from "@astrojs/starlight/props";

const {
	lang,
	editUrl,
	lastUpdated,
	entry: {
		data: { template },
	},
} = Astro.locals.starlightRoute;

const slug = Astro.url.pathname.replace(/^\//, "").replace(/\/$/, "");
const displayTemplate = slug === "" ? "splash" : template;

// Convert config social object to array format that toolbeam expects
const socialArray = Object.entries(config.social || {}).map(([icon, href]) => ({
	icon,
	href,
}));

const links = socialArray || [];
const github = socialArray.find((s) => s.icon === "github");
const discord = socialArray.find((s) => s.icon === "discord");
---

{
	template === "doc" && (
		<footer class="doc">
			<div class="meta sl-flex">
				<div>
					<a href={editUrl} target="_blank" class="sl-flex">
						<Icon name="pencil" size="1em" />
						Edit on GitHub
					</a>
				</div>
				{lastUpdated && (
					<div class="last-updated">
						Last updated: <time datetime={lastUpdated}>{lastUpdated}</time>
					</div>
				)}
			</div>
		</footer>
	)
}

<style>
	footer {
		border-top: 1px solid var(--sl-color-hairline);
		padding-top: 1rem;
		padding-bottom: 1rem;
		font-size: var(--sl-text-sm);
		color: var(--sl-color-gray-3);
	}

	footer.doc .meta {
		justify-content: space-between;
		gap: 1rem;
	}

	a {
		color: var(--sl-color-accent);
		text-decoration: none;
	}

	a:hover {
		text-decoration: underline;
	}

	time {
		font-weight: bold;
	}
</style>
